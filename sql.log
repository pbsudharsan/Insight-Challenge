BEGIN TRANSACTION;

/* Create a table called NAMES */
CREATE TABLE NAMES(Id integer PRIMARY KEY, FName text,LName text,drug_name text,drug_cost float);

/* Create few records in this table */
INSERT INTO NAMES VALUES(1000000001,'Smith','James','AMBIEN',100);
INSERT INTO NAMES VALUES(1000000002,'Garcia','Maria','AMBIEN',200);
INSERT INTO NAMES VALUES(1000000003,'Johnson','James','CHLORPROMAZINE',1000);
INSERT INTO NAMES VALUES(1000000004,'Rodriguez','Maria','CHLORPROMAZINE',2000);
INSERT INTO NAMES VALUES(1000000005,'Smith','David','BENZTROPINE MESYLATE',1500
);
COMMIT;

/* Display all the records from the table */
SELECT   drug_name,COunt( Fname||Lname),sum(drug_cost) from NAMES  group  by drug_name order by sum(drug_cost) DESC,drug_name ;